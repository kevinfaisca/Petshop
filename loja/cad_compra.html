<style>
    .dropdown-menu {
        left: initial !important;
        width: auto;
    }

    labal {
        position: inherit !important;
        color: inherit !important;
        font-size: inherit !important;
    }

    .ul_menuDropdownHeader {
        display: none;
    }

    input#chk_abreMenuDropdown:checked + ul.ul_menuDropdownHeader {
        display: block;
        position: absolute;
        background-color: #005f85;
        z-index: 1000;
        list-style: none;
        padding: 0;
        top: 100%;
        border-bottom-left-radius: 10px;
        border-bottom-right-radius: 10px;
        overflow: hidden;
        box-shadow: 0px 5px 10px 0px #606060
    }

    ul.ul_menuDropdownHeader li {
        color: white;
        padding: 5px;
        transition: 0.3s;
    }

    ul.ul_menuDropdownHeader li:hover {
        background-color: white;
        color: initial;
    }

    ul.ul_menuDropdownHeader a {
        text-decoration: none;
        color: initial;
    }

    .span_opcoesMenu {
        font-size: 14px;
        color: initial;
    }

</style>

<!DOCTYPE html>
<header>
    <div class="row no-gutters m-0" style="background-color: #005f85">
        <div class="menu_topo col-md-10 offset-md-1 col-12">
            <nav class="navbar navbar-expand-lg d-flex justify-content-end" id="navbar_logo">
                <a href="../index.html" class="navbar-brand navbar-nav mr-auto">
                    <img src="../imagens/pngs/logo.png" id="img_logoHeader" style="height: 35px; width: auto;" alt="logo_petShop" />
                </a>
                <div class="mt-2 mt-sm-0 mr-2" style="margin-right:45px;">
                    <span style="color:white;">Olá</span> <span style="color: white; font-weight: 700;"></span>
                    &nbsp;
                    <label for="chk_abreMenuDropdown" class="m-0">
                        <img src="../arquivos/fotoUsuario.png" style="height: 45px; width: 45px; border-radius: 100%; object-fit: cover; cursor: pointer;" alt="fotoUsuario" />
                    </label>
                    <input type="checkbox" name="chk_abreMenuDropdown" id="chk_abreMenuDropdown" style="display:none;" value="" />

                    <ul class="ul_menuDropdownHeader">
                        <li onclick="javascript: window.location.href = '../gerenciadorConteudo/vis_gerenciadorConteudo.html'" style="cursor:pointer;">
                            <span class="span_opcoesMenu">Gerenciador de Conteúdo</span>
                        </li>

                        <li onclick="javascript: window.location.href = 'vis_usuarioPerfil.html'" style="cursor:pointer;">
                            <span class="span_opcoesMenu">Perfil</span>
                        </li>

                        <li onclick="javascript: window.location.href = '../login.html?param=logoff'" style="cursor:pointer;">
                            <span class="span_opcoesMenu">Sair</span>
                        </li>
                    </ul>
                </div>
            </nav>
        </div>
    </div>
</header>
<html lang="PT-BR">
<head>
    <title>PetShop</title>
    <!-- bootstrap para gerenciador de conte�do -->
    <link rel="stylesheet" href="../include/bootstrap/css/bootstrap.css" type="text/css" />

    <!--CSS-->
    <link href="../include/css/styles.css" rel="stylesheet">

    <!--Jquery-->
    <script src="../include/sbadmin/vendor/jquery/jquery-3.6.4.js"></script>
    <link rel="stylesheet" href="../include/css/jquery-ui.css" />
    <link rel="stylesheet" href="../include/jquery-confirm-v3.3.4/css/jquery-confirm.css" />

    <!--==============================================================================-->
    <!--Alerts personalizados-->
    <script src="../include/jquery-confirm-v3.3.4/js/jquery-confirm.js" type="text/javascript"></script>

    <!--Bootstrap MultiSelect -->
    <script src="../include/bootstrap-multiselect-master/dist/js/bootstrap-multiselect.js" type="text/javascript"></script>

    <!--ClipBoard (ctr c) -->
    <script src="../include/js/clipboard/clipboard.min.js" type="text/javascript"></script>

    <!--fun�oes -->
    <script src="../include/js/java_functions.js"></script>

    <!--PAY PAL-->
    <script src="https://www.paypal.com/sdk/js?client-id=AfZDeQgmFcK1IUgH_3YPJDEqHkBlqJq8uhBwCq_07BWV7d9E3S-kVruyu48h0DUWunR4R9vshP1tFW_i&currency=BRL"></script>

</head>
<body>
    <div class="row" style="margin-right:0px;">
        <div class="col-xs-12 col-md-12 noPadding" style="margin-top: 4px;">
            <div class="row">
                <div class="col-xs-10 col-xs-offset-1 col-md-8-offset-2 noPadding"></div>
            </div>
            <form action="/" method="post" name="frm_petshop" autocomplete="off">
                <input type="hidden" name="txt_valor" value="10.00" />
                <input type="hidden" name="txt_nome"  value="10" />


                <div class="row">
                    <div class="col-md-12 noPadding">
                        <div class="row">
                            <div class="col-md-8-offset-2 col-md-8-offset-2 text-center espacamentoPadrao noPadding" style="font-size:25px; color:#524944; margin-top:25px;">
                                <span>Produtos</span>
                                <p id="msg" style="color: red; font-size: 16px; display: none;">Cadastrado com sucesso!</p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row" style="background-color:white; min-height:350px;color:#000;padding:20px;">
                    <div name="div_cadastraProduto" id="div_cadastraProduto">
                        <div class="panel panel-default">
                            <div class="panel-heading">
                                Produtos
                            </div>
                            <div class="panel-body">
                                <div class="row form-group">
                                    <div class="col-xs-12">
                                        <div id="div_img"></div>   
                                        <div>
                                            <span id="span_marca" style="position:relative; top: -230px; left: 215px; font-size: 40px;"></span>
                                            <span id="span_nome" style="position: relative; top: -192px; left: 40px; font-size: 20px;"></span>
                                            <span id="span_moeda" style="position: relative; top: -151px; left: -119px; font-size: 40px; color: #005f85">R$ </span>
                                            <span id="span_preco" style="position: relative; top: -151px; left: -119px; font-size: 40px; color: #005f85"></span>
                                       </div>
                                    </div>
                                </div>

                                <div class="row form-group">
                                    <div class="col-xs-12" style="display:flex; justify-content:center;">
                                        <div id="paypal-button-container">

                                        </div>
                                    </div>
                                </div>

                                <div style="margin-top:30px;"></div>

                                <div class="row">
                                    <div class="col-12 text-center">
                                        <input type="button" class="btn_enviar" id="btn_voltar" name="btn_voltar" value="Voltar" onclick="javascript: window.location.href = '../index.html'" />
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </form>
        </div>
    </div>
    <footer>
        <div id="div_footer" style="position: relative;">
            <div class="row" style="position: absolute; width:100%;">
                <div style="background-color:#005f85;">
                    <div style="display: flex; height: 110px; justify-content: center; align-items: center;">
                        <img src="../imagens/pngs/logo.png" alt="logo_petShop" style="height: 50px; width: auto;" />
                    </div>
                </div>
            </div>
        </div>
    </footer> 
</body>=
</html>

<script type="text/javascript">

window.onload = function () {
        fcn_exibirDados();
    }

    var myApp = {} //Objeto para encapsular variáveis e funções

    myApp.preco = ''; // Variável preco dentro do objeto myApp

    function fcn_exibirDados() {
        fetch("https://localhost:44387/api/Produto/")
            .then(function(response) {
            if (!response.ok) {
                throw new Error("Erro ao obter os dados da API.");
            }
            return response.json();
            })
            .then(function(produtos) {
            // Limpa o conteúdo existente dos elementos HTML
            document.getElementById("span_marca").innerHTML = "";
            document.getElementById("span_nome").innerHTML = "";
            document.getElementById("span_preco").innerHTML = "";

            // Percorre a matriz de produtos
            produtos.forEach(function(produto) {
                // Cria elementos HTML para exibir os dados do produto
                var ds_marca = produto.Marca;
                var marcaElement = document.createElement("span");
                marcaElement.innerHTML = produto.Marca;
                document.getElementById("span_marca").appendChild(marcaElement);

                var ds_nome = produto.Nome;
                var nomeElement = document.createElement("span");
                nomeElement.innerHTML = produto.Nome;
                document.getElementById("span_nome").appendChild(nomeElement);

                var ds_preco = produto.Preco;
                var preco = ds_preco.toString()
                myApp.preco = ds_preco.toString()

                var precoElement = document.createElement("span");
                precoElement.innerHTML = produto.Preco;
                document.getElementById("span_preco").appendChild(precoElement);

                var imagemProduto = produto.Imagem;
                var imgElement = document.createElement("img");
                imgElement.src = '../imagens/pngs/' + imagemProduto;
                imgElement.alt = 'Produto';
                imgElement.style.height = '200px';
                imgElement.style.width = '200px';
                imgElement.style.margintop = '20px';
                imgElement.style.marginBottom = '20px';
                document.getElementById("div_img").appendChild(imgElement);
            });
            })
            .catch(function(error) {
            console.error(error);
            });
    }
    paypal.Buttons({
        createOrder: function (data, actions) {
            return actions.order.create({
                purchase_units: [{
                    amount: {
                        currency_code: 'BRL',
                        value: '299.99',
                        breakdown: {
                            item_total: {
                                currency_code: 'BRL',
                                value: '299.99',
                            }
                        }
                    },
                    items: [
                        {
                            name: 'Produto 1',
                            description: 'Descricao do Produto 1',
                            quantity: '1',
                            unit_amount: {
                                currency_code: 'BRL',
                                value: '99.99',
                            },
                            tax: {
                                currency_code: 'BRL',
                                value: '0',
                            }
                        },
                        {
                            name: 'Produto 2',
                            description: 'Descricao do Produto 2',
                            quantity: '2',
                            unit_amount: {
                                currency_code: 'BRL',
                                value: '100.00',
                            },
                            tax: {
                                currency_code: 'BRL',
                                value: '0',
                            }
                        }

                    ]

                }]
            });
        },

        onApprove: function (data, actions) {
            // Aqui você pode exibir os detalhes do produto para o cliente
            var order = actions.order.capture().then(function (orderData) {
                console.log('Detalhes do pedido:', orderData);
                console.log('Pagamento aprovado!');

                //Redirecionar para página de finalização de compra
                window.location.href = 'vis_finalizaCompra.html'
            }).catch(function(error) {
            console.error("Erro ao capturar pedido: ", error);
            console.log('Pagamento não aprovado!');

            //Lidar com pagamento não aprovado - redirecionar para uma página de erro
            window.location.href = 'vis_pagamentoNaoAprovado.html'
            });
        }
    }).render('#paypal-button-container')
     
</script>